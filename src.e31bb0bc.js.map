{"version":3,"sources":["scripts/helper.js","scripts/preprocess.js","scripts/grouped-quantile.js","index.js","../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["generateMapG","width","height","d3","select","append","attr","generateMarkerG","setCanvasSize","appendGraphLabels","g","initPanelDiv","style","getSimulation","data","forceSimulation","features","alphaDecay","velocityDecay","force","forceCollide","strength","simulate","simulation","on","selectAll","d","x","y","getProjection","geoMercator","center","scale","getPath","projection","geoPath","getClosestStep","nSteps","domain","BEST_STEPS","step","stepDiff","bestStep","length","i","push","Math","abs","getSteps","steps","firstStep","floor","unshift","getQuantiles","array","sort","ascending","quantiles","quantile","median","addDayType","jour_semaine","date","getDay","type_jour","isNaN","voyage","ferie","aggregateData","csvData","vizData","startDate","endDate","typeJour","ligne","girouettes","posLigne","findIndex","e","posGirouette","girouette","Girouette","voyages","posVoyage","arrets","posArret","codeArret","arret_code","nomArret","arret_nom","sequenceArret","sequence_arret","minutesEcart","moyMinutesEcart","nClients","moyNClients","ponctualite","tauxPonctualite","minutesEcartClient","moyMinutesEcartClient","Minutes_ecart_planifie","montants","Etat_Ponctualite","average","arr","reduce","a","b","toFixed","computeTauxPonctualite","filter","forEach","arret","MARGIN","top","right","bottom","left","FONT_SIZE","DIRECTIONS_ANGLE","QUANTILE_STROKE_COLOR","QUANTILE_FILL_COLOR","QUANTILE_STROKE_WIDTH","NUMBER_OF_TICKS","GRADIENT_COLORS","GRADIENT_THRESHOLDS","generateViz3","container","delayGraphContainer","trafficGraphContainer","lines","directions","ResizeObserver","generateDelayGraph","observe","node","generateTrafficGraph","quantileSets","getDelayQuantileSets","title","generateGroupedQuantileGraph","svg","dataScale","HEIGHT","getBoundingClientRect","WIDTH","min","enter","insert","text","legend","middleY","squareWidth","paddingX","paddingY","getTrafficQuantileSets","html","BAR_WIDTH","linesScale","scaleOrdinal","range","directionsRange","line","directionsScale","maxValue","Number","MIN_SAFE_INTEGER","minValue","MAX_SAFE_INTEGER","scaleLinear","xAxis","lineValuesY","directionValuesY","yAxis","helper","bars","q3","q2","q1","j","round","direction","delays","trip","stop","tripNClients","svgSize","Date","build","csv","then","arret_Latitude","arret_Longitude","preprocess","groupedQuantile","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","hotData","_acceptCallbacks","_disposeCallbacks","accept","fn","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","location","protocol","ws","onmessage","event","JSON","parse","type","handled","assets","asset","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","id","every","generated","js","console","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","log","removeErrorOverlay","error","message","stack","overlay","createErrorOverlay","document","body","appendChild","getElementById","remove","createElement","stackTrace","innerText","innerHTML","getParents","modules","parents","k","dep","Array","isArray","concat","Function","deps","cached","cache","some","cb"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"..\\src","sourcesContent":["\r\n/**\r\n * Generates the SVG element g which will contain the map base.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMapG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'map-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Generates the SVG element g which will contain the map markers.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMarkerG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'marker-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Sets the size of the SVG canvas containing the graph.\r\n *\r\n * @param {number} width The desired width\r\n * @param {number} height The desired height\r\n */\r\nexport function setCanvasSize (width, height) {\r\n  d3.select('#map').select('svg')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Appends the labels for the graph.\r\n *\r\n * @param {*} g The d3 Selection of the graph's g SVG element\r\n */\r\nexport function appendGraphLabels (g) {\r\n /* g.append('text')\r\n    .text('Achalandage et ponctualité des lignes de bus 9 et 22 de la couronne Nord de Montréal')\r\n    .attr('class', 'title')\r\n    .attr('fill', '#000000')\r\n    .attr('font-family', 'myriad-pro')\r\n    .attr('font-size', 28)\r\n    .attr('transform', 'translate(50, 50)')\r\n\r\n  g.append('text')\r\n    .text('Sous-titre')\r\n    .attr('class', 'title')\r\n    .attr('fill', '#000000')\r\n    .attr('font-family', 'myriad-pro')\r\n    .attr('font-size', 18)\r\n    .attr('transform', 'translate(50, 85)') */\r\n}\r\n\r\n/**\r\n * Initializes the div which will contain the information panel.\r\n */\r\nexport function initPanelDiv () {\r\n  d3.select('.graph')\r\n    .append('div')\r\n    .attr('id', 'panel')\r\n    .style('width', '215px')\r\n    .style('border', '1px solid black')\r\n    .style('padding', '10px')\r\n    .style('visibility', 'hidden')\r\n}\r\n\r\n/**\r\n * Initializes the simulation used to place the circles\r\n *\r\n * @param {object} data The data to be displayed\r\n * @returns {*} The generated simulation\r\n */\r\nexport function getSimulation (data) {\r\n  return d3.forceSimulation(data.features)\r\n    .alphaDecay(0)\r\n    .velocityDecay(0.75)\r\n    .force('collision',\r\n      d3.forceCollide(5)\r\n        .strength(1)\r\n    )\r\n}\r\n\r\n/**\r\n * Update the (x, y) position of the circles'\r\n * centers on each tick of the simulation.\r\n *\r\n * @param {*} simulation The simulation used to position the cirles.\r\n */\r\nexport function simulate (simulation) {\r\n  simulation.on('tick', () => {\r\n    d3.selectAll('.marker')\r\n      .attr('cx', (d) => d.x)\r\n      .attr('cy', (d) => d.y)\r\n  })\r\n}\r\n\r\n/**\r\n * Sets up the projection to be used.\r\n *\r\n * @returns {*} The projection to use to trace the map elements\r\n */\r\nexport function getProjection () {\r\n  return d3.geoMercator()\r\n    .center([-73.708879, 45.579611])\r\n    .scale(70000)\r\n}\r\n\r\n/**\r\n * Sets up the path to be used.\r\n *\r\n * @param {*} projection The projection used to trace the map elements\r\n * @returns {*} The path to use to trace the map elements\r\n */\r\nexport function getPath (projection) {\r\n  return d3.geoPath()\r\n    .projection(projection)\r\n}\r\n\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {number} The best step to use\r\n */\r\nexport function getClosestStep (nSteps, domain) {\r\n  const BEST_STEPS = [\r\n    0.1, 0.2, 0.25, 0.5,\r\n    1, 2, 2.5, 5,\r\n    10, 20, 25, 50,\r\n    100, 200, 250, 500,\r\n    1000, 2000, 2500, 5000,\r\n    10000, 20000, 25000, 50000\r\n  ]\r\n  var step = (domain[1] - domain[0]) / nSteps\r\n  var stepDiff = []\r\n  var bestStep = BEST_STEPS[BEST_STEPS.length - 1]\r\n  for (let i = 0; i < BEST_STEPS.length; i++) {\r\n    stepDiff.push(Math.abs(BEST_STEPS[i] - step))\r\n    if (i > 0 && stepDiff[i] > stepDiff[i - 1]) {\r\n      bestStep = BEST_STEPS[i - 1]\r\n      break\r\n    }\r\n  }\r\n  return bestStep\r\n}\r\n\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {Array<number>} The best steps\r\n */\r\nexport function getSteps (nSteps, domain) {\r\n  var step = getClosestStep(nSteps, domain)\r\n  var steps = []\r\n  if (domain[0] <= 0 && domain[1] >= 0) {\r\n    steps.push(0)\r\n  } else {\r\n    let firstStep = Math.floor(domain[0])\r\n    while (firstStep % step !== 0) {\r\n      firstStep += 1\r\n    }\r\n    steps.push(firstStep)\r\n  }\r\n  while (steps[steps.length - 1] < domain[1] - step) {\r\n    steps.push(steps[steps.length - 1] + step)\r\n  }\r\n  while (steps[0] > domain[0] + step) {\r\n    steps.unshift(steps[0] - step)\r\n  }\r\n  return steps\r\n}\r\n\r\n/**\r\n * @param {Array<number>} array Array of numeric values\r\n * @returns {Array<number>} The quantiles\r\n */\r\nexport function getQuantiles (array) {\r\n  array = array.sort(d3.ascending)\r\n  const quantiles = [\r\n    array[0],\r\n    d3.quantile(array, 0.25),\r\n    d3.median(array),\r\n    d3.quantile(array, 0.75),\r\n    array[array.length - 1]\r\n  ]\r\n  return quantiles\r\n}\r\n","// INF8808 - Exo\r\n//\r\n// Adam Prévost - 1947205\r\n// Armelle Jézéquel - 2098157\r\n// Clara Serruau - 2164678\r\n// Jules Lefebvre - 1847158\r\n// Julien Dupuis - 1960997\r\n//\r\n\r\n/**\r\n * Ajout de champs à l'objet\r\n * jour_semaine {0, 1, 2, 3, 4, 5, 6} où 0 = Dimanche\r\n * type_jour {semaine, fin de semaine}\r\n * ferie {true, false}\r\n *\r\n * @param {object[]} data L'array d'objets qui contient les lignes du csv\r\n */\r\n export function addDayType (data) {\r\n  for (var i = 0; i < data.length; i++) {\r\n    // jour_semaine\r\n    data[i].jour_semaine = data[i].date.getDay()\r\n\r\n    // type_jour\r\n    data[i].jour_semaine === (0 || 6) ? data[i].type_jour = 'fin de semaine' : data[i].type_jour = 'semaine'\r\n\r\n    // ferie\r\n    isNaN(data[i].voyage) ? data[i].ferie = true : data[i].ferie = false\r\n  }\r\n}\r\n/**\r\n * aggregateData() remplit l'objet vizData à partir des données du csv (data)\r\n *\r\n * @param {*} csvData L'array d'objets qui contient les lignes du csv, modifié par preprocess.addDayType()\r\n * @param {*} vizData L'array d'objets qui contient les données consolidées requises pour générer les viz\r\n * @param {*} startDate Date de début\r\n * @param {*} endDate Date de fin\r\n * @param {*} typeJour On considère semaine ou weekend\r\n * @param {*} ferie On considère les fériés si true\r\n */\r\nexport function aggregateData (csvData, vizData, startDate, endDate, typeJour, ferie) {\r\n  // Boucle sur les lignes de csvData pour remplir la structure vizData\r\n  for (var i = 0; i < csvData.length; i++) {\r\n    if (csvData[i].date >= startDate && csvData[i].date <= endDate && csvData[i].type_jour === typeJour && csvData[i].ferie === ferie) {\r\n      if (vizData.length === 0) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n      }\r\n\r\n      // On ajoute la ligne si elle n'existe pas déjà dans vizData\r\n      var posLigne = vizData.findIndex(e => e.ligne === csvData[i].ligne)\r\n      if (posLigne === -1) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n        posLigne = vizData.length - 1\r\n      }\r\n\r\n      // On ajoute la girouette si elle n'existe pas déjà dans vizData\r\n      var posGirouette = vizData[posLigne].girouettes.findIndex(e => e.girouette === csvData[i].Girouette)\r\n      if (posGirouette === -1) {\r\n        vizData[posLigne].girouettes.push({ girouette: csvData[i].Girouette, voyages: [] })\r\n        posGirouette = vizData[posLigne].girouettes.length - 1\r\n      }\r\n\r\n      // On ajoute le voyage s'il n'existe pas déjà dans vizData\r\n      var posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.findIndex(e => e.voyage === csvData[i].voyage)\r\n      if (posVoyage === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages.push({ voyage: csvData[i].voyage, arrets: [] })\r\n        posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.length - 1\r\n      }\r\n\r\n      // On ajoute l'arrêt s'il n'existe pas déjà dans vizData\r\n      var posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.findIndex(e => e.codeArret === csvData[i].arret_code)\r\n      if (posArret === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.push(\r\n          {\r\n            codeArret: csvData[i].arret_code,\r\n            nomArret: csvData[i].arret_nom,\r\n            sequenceArret : csvData[i].sequence_arret,\r\n            minutesEcart: [],\r\n            moyMinutesEcart: null,\r\n            nClients: [],\r\n            moyNClients: null,\r\n            ponctualite: [],\r\n            tauxPonctualite: null,\r\n            minutesEcartClient: [],\r\n            moyMinutesEcartClient: null\r\n          })\r\n        posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.length - 1\r\n      }\r\n\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcart.push(csvData[i].Minutes_ecart_planifie)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].nClients.push(csvData[i].montants)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].ponctualite.push(csvData[i].Etat_Ponctualite)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcartClient.push(csvData[i].Minutes_ecart_planifie * csvData[i].montants)\r\n    }\r\n  }\r\n\r\n  // Fonctions pour créer les indicateurs\r\n  const average = arr => +(arr.reduce((a, b) => a + b, 0) / arr.length).toFixed(2) // https://poopcode.com/calculate-the-average-of-an-array-of-numbers-in-javascript/\r\n  const computeTauxPonctualite = arr => arr.filter(x => x === 'Ponctuel').length / arr.length\r\n\r\n  // Parcours de vizData pour calculer les indicateurs pour chaque ligne.arret\r\n  vizData.forEach(function (ligne) {\r\n    ligne.girouettes.forEach(function (girouette) {\r\n      girouette.voyages.forEach(function (voyage) {\r\n        voyage.arrets.forEach(function (arret) {\r\n          arret.moyMinutesEcart = average(arret.minutesEcart)\r\n          arret.moyNClients = average(arret.nClients)\r\n          arret.moyMinutesEcartClient = average(arret.minutesEcartClient)\r\n          arret.tauxPonctualite = computeTauxPonctualite(arret.ponctualite)\r\n        })\r\n      })\r\n    })\r\n  })\r\n}\r\n","import * as helper from './helper.js'\r\n\r\nconst MARGIN = { top: 52, right: 100, bottom: 125, left: 100 }\r\nconst FONT_SIZE = 14\r\nconst DIRECTIONS_ANGLE = -45\r\nconst QUANTILE_STROKE_COLOR = 'black'\r\nconst QUANTILE_FILL_COLOR = 'lightgray'\r\nconst QUANTILE_STROKE_WIDTH = 2\r\nconst NUMBER_OF_TICKS = 10\r\nconst GRADIENT_COLORS = ['#ff9999', '#99ff99', '#ffff99']\r\nconst GRADIENT_THRESHOLDS = ['10', '5', '0', '-5']\r\n\r\n/**\r\n * @param vizData\r\n */\r\nexport function generateViz3 (vizData) {\r\n  // Split container in two\r\n  var container = d3.select('#grouped-quantile-graph-container')\r\n  var delayGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'left')\r\n  var trafficGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'right')\r\n\r\n  // TODO: Fetch data\r\n  var data = {}\r\n  data.lines = ['9', '22']\r\n  data.directions = ['Lafontaine', 'Montmorency', 'Côté', 'George VI']\r\n\r\n  // Regenerate graphs on resize\r\n  new ResizeObserver(() => { generateDelayGraph(delayGraphContainer, data, vizData) })\r\n    .observe(delayGraphContainer.node())\r\n  new ResizeObserver(() => { generateTrafficGraph(trafficGraphContainer, data, vizData) })\r\n    .observe(trafficGraphContainer.node())\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n * @param vizData\r\n */\r\nexport function generateDelayGraph (container, data, vizData) {\r\n  // Fetch data\r\n  data.quantileSets = getDelayQuantileSets(vizData)\r\n\r\n  // Generate common graph\r\n  data.title = 'Retard Moyen'\r\n  var [svg, dataScale] = generateGroupedQuantileGraph(container, data)\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n  var WIDTH = Math.min(HEIGHT, container.node().getBoundingClientRect().width)\r\n\r\n  // Set gradients\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'late-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[0], GRADIENT_COLORS[1]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'early-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[1], GRADIENT_COLORS[2]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  // Draw gradients\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[0]) - MARGIN.top)\r\n    .attr('y', MARGIN.top)\r\n    .attr('fill', GRADIENT_COLORS[0])\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[1]) - dataScale(GRADIENT_THRESHOLDS[0]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[0]))\r\n    .attr('fill', 'url(#late-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[2]) - dataScale(GRADIENT_THRESHOLDS[1]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[1]))\r\n    .attr('fill', GRADIENT_COLORS[1])\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[3]) - dataScale(GRADIENT_THRESHOLDS[2]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[2]))\r\n    .attr('fill', 'url(#early-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', HEIGHT - MARGIN.bottom - dataScale(GRADIENT_THRESHOLDS[3]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[3]))\r\n    .attr('fill', GRADIENT_COLORS[2])\r\n\r\n  // Set y axis label\r\n  svg.select('#y-axis > .label')\r\n    .text('Minute')\r\n    .attr('fill', '#898989')\r\n\r\n  // Legend\r\n  const legend = svg.insert('g', '#x-axis').style(\"font-size\",\"12px\")\r\n  const middleY = (HEIGHT - MARGIN.top - MARGIN.bottom) / 2 + MARGIN.top\r\n  const squareWidth = FONT_SIZE * 2 / 3\r\n  const paddingX = FONT_SIZE * 2\r\n  const paddingY = FONT_SIZE * 1.5\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY - paddingY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[0])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY - paddingY + squareWidth)\r\n    .text('Retard')\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[1])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY + squareWidth)\r\n    .text('Ponctuel')\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY + paddingY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[2])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY + paddingY + squareWidth)\r\n    .text('Avance')\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n * @param vizData\r\n */\r\nexport function generateTrafficGraph (container, data, vizData) {\r\n  // Fetch data\r\n  data.quantileSets = getTrafficQuantileSets(vizData, 'moyMinutesEcart')\r\n\r\n  // Generate common graph\r\n  data.title = 'Achalandage Moyen'\r\n  var [svg] = generateGroupedQuantileGraph(container, data)\r\n  // Set y axis label\r\n  svg.select('#y-axis > .label')\r\n    .text(\"\")\r\n  svg.select('#y-axis > .label')\r\n    .append('tspan')\r\n    .attr(\"x\",\"88\")\r\n    .attr(\"y\",\"21\")\r\n    .text(\"Nombre\")\r\n  svg.select('#y-axis > .label')\r\n    .append('tspan')\r\n    .attr(\"dx\",\"-51\")\r\n    .attr(\"dy\",\"15\")\r\n    .text(\"de personnes\")\r\n    svg.select('#y-axis > .label')\r\n    .append('tspan')\r\n    .attr(\"dx\",\"-84\")\r\n    .attr(\"dy\",\"14\")\r\n    .text(\"par trajet\")\r\n    /*.text('Nombre de personnes par trajet')\r\n    .attr('fill', '#898989')*/\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to display\r\n * @returns {Selection} The generated graph as svg\r\n */\r\nexport function generateGroupedQuantileGraph (container, data) {\r\n  // ===================== SETUP =====================\r\n\r\n  // Delete existing content\r\n  container.html('')\r\n  // Set size\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n  var WIDTH = Math.min(HEIGHT, container.node().getBoundingClientRect().width)\r\n  var BAR_WIDTH = (WIDTH - MARGIN.left - MARGIN.right) / 7\r\n  // Create svg\r\n  var svg = container.append('svg')\r\n    .attr('width', WIDTH)\r\n    .attr('height', HEIGHT)\r\n    .attr('style', 'display: block; margin: auto')\r\n\r\n  // ===================== SCALES =====================\r\n\r\n  // Create lines scale\r\n  var linesScale = d3.scaleOrdinal()\r\n    .domain(data.lines)\r\n    .range([MARGIN.left + 2 * BAR_WIDTH, MARGIN.left + 5 * BAR_WIDTH])\r\n  // Create directions scale\r\n  var directionsRange = []\r\n  for (const line of data.lines) {\r\n    directionsRange.push(linesScale(line) - BAR_WIDTH / 2)\r\n    directionsRange.push(linesScale(line) + BAR_WIDTH / 2)\r\n  }\r\n  var directionsScale = d3.scaleOrdinal()\r\n    .domain([...data.directions])\r\n    .range(directionsRange)\r\n  // Create data scale\r\n  var maxValue = Number.MIN_SAFE_INTEGER\r\n  var minValue = Number.MAX_SAFE_INTEGER\r\n  for (const quantiles of data.quantileSets) {\r\n    for (const quantile of quantiles) {\r\n      if (maxValue < quantile) {\r\n        maxValue = quantile\r\n      }\r\n      if (minValue > quantile) {\r\n        minValue = quantile\r\n      }\r\n    }\r\n  }\r\n  var dataScale = d3.scaleLinear()\r\n    .domain([minValue, maxValue])\r\n    .range([HEIGHT - MARGIN.bottom - FONT_SIZE / 2, MARGIN.top + FONT_SIZE / 2])\r\n\r\n  // ===================== X AXIS =====================\r\n\r\n  var xAxis = svg.append('g')\r\n    .attr('id', 'x-axis')\r\n  // Draw axis line\r\n  xAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom],\r\n      [MARGIN.left + 7 * BAR_WIDTH, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Draw line values\r\n  const lineValuesY = HEIGHT - MARGIN.bottom + FONT_SIZE * 1.5\r\n  for (const line of data.lines) {\r\n    xAxis.append('text')\r\n      .attr('x', linesScale(line))\r\n      .attr('y', lineValuesY)\r\n      .attr('text-anchor', 'middle')\r\n      .text(line)\r\n    .attr('fill', '#898989')\r\n      .style('font-size', FONT_SIZE)\r\n  }\r\n  // Draw direction values\r\n  const directionValuesY = lineValuesY + FONT_SIZE\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    xAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('transform', `translate(${x}, ${directionValuesY}) rotate(${DIRECTIONS_ANGLE})`)\r\n      .text(data.directions[i])\r\n      .style('font-size', \"12px\")\r\n      .attr('font-family', 'sans-serif')\r\n      .attr('class', `direction${i} label`)\r\n  }\r\n  // Draw labels\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', lineValuesY)\r\n    .text('Ligne')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', directionValuesY + FONT_SIZE)\r\n    .text('Direction')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== Y AXIS =====================\r\n\r\n  var yAxis = svg.append('g')\r\n    .attr('id', 'y-axis')\r\n  // Draw axis line\r\n  yAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, MARGIN.top],\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Generate steps\r\n  var steps = helper.getSteps(NUMBER_OF_TICKS, dataScale.domain())\r\n  for (const step of steps) {\r\n    const y = dataScale(step)\r\n    // Draw data values\r\n    yAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('x', MARGIN.left - FONT_SIZE)\r\n      .attr('y', y + FONT_SIZE / 3)\r\n      .text(step)\r\n      .attr('font-family', 'sans-serif')\r\n      .style('font-size', FONT_SIZE)\r\n    // Draw ticks\r\n    yAxis.append('path')\r\n      .attr('d', d3.line()([\r\n        [MARGIN.left - FONT_SIZE / 2, y],\r\n        [MARGIN.left, y]]\r\n      ))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n  }\r\n  // Draw labels\r\n  yAxis.append('text')\r\n    .attr('x', MARGIN.left - FONT_SIZE / 2)\r\n    .attr('y', MARGIN.top - FONT_SIZE / 2)\r\n    .attr('class', 'label')\r\n    .attr('text-anchor', 'end')\r\n    .text('Unité de données')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== CANDLES =====================\r\n\r\n  var bars = svg.append('g')\r\n    .attr('id', 'candles')\r\n\r\n  // HISTOGRAMME\r\n\r\n  /* for (let i = 0; i < data.quantileSets.length; i++) {\r\n    // Features of the histogram\r\n    var histogram = d3.histogram()\r\n      .domain(dataScale.domain())\r\n      .thresholds(dataScale.ticks(50)) // Important: how many bins approx are going to be made? It is the 'resolution' of the violin plot\r\n      .value(d => d)\r\n    const bins = histogram(data.quantileSets[i])\r\n    // What is the biggest number of value in a bin? We need it cause this value will have a width of 100% of the bandwidth.\r\n    var maxNum = 0\r\n    for (const bin of bins) {\r\n      if (bin.length > maxNum) {\r\n        maxNum = bin.length\r\n      }\r\n    }\r\n    // The maximum width of a violin must be x.bandwidth = the width dedicated to a group\r\n    var xNum = d3.scaleLinear()\r\n      .range([0, BAR_WIDTH])\r\n      .domain([-maxNum, maxNum])\r\n    // Add the shape to this svg!\r\n    const areaGenerator = d3.area()\r\n      .x0((d) => xNum(-d.length))\r\n      .x1((d) => xNum(d.length))\r\n      .y((d) => dataScale(d.x0))\r\n      .curve(d3.curveStep)\r\n    bars.append('path')\r\n      .attr('transform', `translate(${directionsScale(data.directions[i]) - BAR_WIDTH / 2})`)\r\n      .style('fill', '#69b3a2')\r\n      .attr('d', areaGenerator(bins))\r\n  } */\r\n\r\n  for (let i = 0; i < data.quantileSets.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    const top = dataScale(data.quantileSets[i][4])\r\n    const q3 = dataScale(data.quantileSets[i][3])\r\n    const q2 = dataScale(data.quantileSets[i][2])\r\n    const q1 = dataScale(data.quantileSets[i][1])\r\n    const bottom = dataScale(data.quantileSets[i][0])\r\n    // Draw domain line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x, top], [x, bottom]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q1 to Q3 bar\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', x - BAR_WIDTH / 2)\r\n      .attr('height', q1 - q3)\r\n      .attr('y', q3)\r\n      .attr('fill', QUANTILE_FILL_COLOR)\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q2 line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x - BAR_WIDTH / 2, q2], [x + BAR_WIDTH / 2, q2]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw quantile values\r\n    for (let j = 0; j < data.quantileSets[i].length; j++) {\r\n      const quantile = bars.append('g')\r\n        .attr('class', `direction${i} quantile`)\r\n        .style('visibility', 'hidden')\r\n      const x = directionsScale(data.directions[i]) + (i % 2 === 0 ? -1 : 1) * (BAR_WIDTH / 2 + FONT_SIZE / 2)\r\n      const y = dataScale(data.quantileSets[i][j])\r\n      quantile.append('text')\r\n        .attr('x', x)\r\n        .attr('y', y)\r\n        .attr('text-anchor', (i % 2 === 0 ? 'end' : 'start'))\r\n        .text(Math.round(data.quantileSets[i][j]))\r\n        .style('font-size', FONT_SIZE)\r\n        .attr('id', `quantile-text-${i}-${j}`)\r\n    }\r\n  }\r\n\r\n  // ===================== HOVER =====================\r\n\r\n  // Create triggers\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', directionsScale(data.directions[i]) - BAR_WIDTH / 2)\r\n      .attr('height', dataScale.range()[0] - dataScale.range()[1] + FONT_SIZE)\r\n      .attr('y', MARGIN.top)\r\n      .attr('fill', 'transparent')\r\n      // Highlight direction\r\n      .on('mouseover', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH * 2)\r\n        d3.selectAll(`.direction${i}.label`)\r\n          .attr(\"font-weight\", 1000)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'visible')\r\n      // Unhighlight direction\r\n      }).on('mouseout', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n        d3.selectAll(`.direction${i}.label`)\r\n        .attr(\"font-weight\", 0)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'hidden')\r\n      })\r\n  }\r\n\r\n  // ===================== OTHER =====================\r\n\r\n  // Draw Title\r\n  svg.append('text')\r\n    .attr('x', (WIDTH - MARGIN.right - MARGIN.left) / 2 + MARGIN.left)\r\n    .attr('y', MARGIN.top - FONT_SIZE * 2)\r\n    .attr('text-anchor', 'middle')\r\n    .text(data.title)\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  return [svg, dataScale]\r\n}\r\n\r\n/**\r\n * @param {object} vizData Project data\r\n * @returns {Array<number>} The quantile sets\r\n */\r\nexport function getDelayQuantileSets (vizData) {\r\n  const quantileSets = []\r\n  for (const line of vizData) {\r\n    for (const direction of line.girouettes) {\r\n      const delays = []\r\n      for (const trip of direction.voyages) {\r\n        for (const stop of trip.arrets) {\r\n          delays.push(stop.moyMinutesEcart)\r\n        }\r\n      }\r\n      quantileSets.push(helper.getQuantiles(delays))\r\n    }\r\n  }\r\n  return quantileSets\r\n}\r\n\r\n/**\r\n * @param {object} vizData Project data\r\n * @returns {Array<number>} The quantile sets\r\n */\r\nexport function getTrafficQuantileSets (vizData) {\r\n  const quantileSets = []\r\n  for (const line of vizData) {\r\n    for (const direction of line.girouettes) {\r\n      const tripNClients = []\r\n      for (const trip of direction.voyages) {\r\n        let nClients = 0\r\n        for (const stop of trip.arrets) {\r\n          nClients += stop.moyNClients\r\n        }\r\n        tripNClients.push(nClients)\r\n      }\r\n      quantileSets.push(helper.getQuantiles(tripNClients))\r\n    }\r\n  }\r\n  return quantileSets\r\n}\r\n","'use strict'\r\n\r\nimport * as helper from './scripts/helper.js'\r\nimport * as preprocess from './scripts/preprocess.js'\r\nimport * as groupedQuantile from './scripts/grouped-quantile.js'\r\n\r\n/**\r\n * @file \r\n * @author Adam Prévost, Armelle Jézéquel, Clara Serruau, Jules Lefebvre, Julien Dupuis\r\n * @version 1.0.0\r\n * \r\n * La structure du projet est inspirée de celle employé pour les TPs de INF8808 créée par Olivia Gélinas.\r\n */\r\n\r\n(function (d3) {\r\n  const svgSize = {\r\n    width: 800,\r\n    height: 625\r\n  }\r\n\r\n  helper.setCanvasSize(svgSize.width, svgSize.height)\r\n  helper.generateMapG(svgSize.width, svgSize.height)\r\n  helper.generateMarkerG(svgSize.width, svgSize.height)\r\n  helper.appendGraphLabels(d3.select('.main-svg'))\r\n  helper.initPanelDiv()\r\n\r\n  // Solution temporaire, éventuellement l'utilisateur peut choisir la période qui l'intéresse, s'il veut inclure les week-end et les fériés.\r\n  const startDate = new Date('2021-09-01')\r\n  const endDate = new Date('2021-12-01')\r\n  const typeJour = 'semaine'\r\n  const ferie = false\r\n\r\n  var vizData = []\r\n\r\n  build()\r\n\r\n  /**\r\n   *   Cette fonction construit la page web\r\n   */\r\n  function build () {\r\n    d3.csv('./donnees_L9_L22.csv').then(function (csvData) {\r\n      // Change les string pour les types appropriés\r\n      csvData.forEach(function (d) {\r\n        d.date = new Date(d.date + ' 00:00:00')\r\n        d.ligne = +d.ligne\r\n        d.voyage = +d.voyage\r\n        d.arret_code = +d.arret_code\r\n        d.montants = +d.montants\r\n        d.Minutes_ecart_planifie = +d.Minutes_ecart_planifie\r\n        d.sequence_arret = +d.sequence_arret\r\n        d.arret_Latitude = +d.arret_Latitude\r\n        d.arret_Longitude = +d.arret_Longitude\r\n      })\r\n      //console.log(csvData)\r\n      preprocess.addDayType(csvData)\r\n      preprocess.aggregateData(csvData, vizData, startDate, endDate, typeJour, ferie)\r\n      \r\n      groupedQuantile.generateViz3(vizData);\r\n    })\r\n  }\r\n})(d3)\r\n","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel] ✨ Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel] 🚨  ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\">🚨</span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}