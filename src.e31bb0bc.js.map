{"version":3,"sources":["scripts/helper.js","scripts/preprocess.js","scripts/grouped-quantile.js","index.js"],"names":["generateMapG","width","height","d3","select","append","attr","generateMarkerG","setCanvasSize","getClosestStep","nSteps","domain","BEST_STEPS","step","stepDiff","bestStep","length","i","push","Math","abs","getSteps","steps","firstStep","floor","unshift","getQuantiles","array","sort","ascending","quantiles","quantile","median","getWeekNumber","d","Date","UTC","getFullYear","getMonth","getDate","setUTCDate","getUTCDate","getUTCDay","yearStart","getUTCFullYear","weekNo","ceil","addDayType","data","jour_semaine","date","getDay","type_jour","isNaN","voyage","ferie","aggregateData","csvData","vizData","startDate","endDate","typeJour","ligne","girouettes","posLigne","findIndex","e","posGirouette","girouette","Girouette","voyages","posVoyage","arrets","posArret","codeArret","arret_code","nomArret","arret_nom","sequenceArret","sequence_arret","minutesEcart","Map","moyMinutesEcart","nClients","moyNClients","ponctualite","tauxPonctualite","minutesEcartClient","moyMinutesEcartClient","set","Minutes_ecart_planifie","montants","Etat_Ponctualite","forEach","arret","sumMinutesEcart","v","size","sumNClients","sumMinutesEcartClient","countPonctuel","aggregateDataForViz3","lignes","posDate","valueOf","MARGIN","top","right","bottom","left","FONT_SIZE","DIRECTIONS_ANGLE","QUANTILE_STROKE_COLOR","QUANTILE_FILL_COLOR","QUANTILE_STROKE_WIDTH","NUMBER_OF_TICKS","GRADIENT_COLORS","GRADIENT_THRESHOLDS","selectValue","generateViz3","container","delayGraphContainer","style","trafficGraphContainer","lines","directions","ResizeObserver","generateDelayGraph","observe","node","generateTrafficGraph","quantileSets","getDelayQuantileSets","title","generateGroupedQuantileGraph","svg","dataScale","HEIGHT","getBoundingClientRect","WIDTH","min","selectAll","enter","insert","text","legend","middleY","squareWidth","paddingX","paddingY","getTrafficQuantileSets","quantileTripSets","quantileDaySets","quantileWeekSets","weekOption","document","createElement","value","innerHTML","dayOption","tripOption","appendChild","addEventListener","setTrafficGraph","setAttribute","toString","html","BAR_WIDTH","linesScale","scaleOrdinal","range","directionsRange","line","directionsScale","maxValue","Number","MIN_SAFE_INTEGER","minValue","MAX_SAFE_INTEGER","scaleLinear","xAxis","lineValuesY","directionValuesY","x","yAxis","helper","y","bars","q3","q2","q1","yValues","minOffset","centerOffset","max","j","round","on","delaySets","day","direction","trip","stop","delaySet","tripSets","daySets","weekSets","lastWeek","parse","weekClients","week","dayClients","tripClients","tripSet","daySet","weekSet","svgSize","build","csv","then","arret_Latitude","arret_Longitude","preprocess","groupedQuantile"],"mappings":"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AG,EAAxB,ADmCU,GEQJ,CAAsByC,CFRC,CAAvB,EAA0B,GEQ1B;AACAqK,AD3CN,AF0CO,ACPCpK,ICnCF0D,EC2CA0G,EFREpK,CDOQjD,MCPD,CEQC,AFRAS,CEQCmF,ED3CI,CDmCb,CAAa,CCnCG,CAAC,AF0ClB,CAAyB3F,MAAzB,EE1CiB,AF0CgBC,EE1CJ,GC2C9B,CAAgC8C,AHD/B,EAAyC,GE1CxB,EC2ClB,AD3CyC,EC2CAC,OAAzC,AD3CkB,CAAxB,CC2CwDC,SAAlD,EAA6DC,OAA7D,EAAsEC,QAAtE,EAAgFN,KAAhF;AACAwK,AD3CN,AF0CE,ACRqBjK,IClCjBuD,EC2CA0G,AHDEnN,ICRekD,KAAK,CDQV,CCRYL,EDQT,CACjB,CGAiB,CAAC8D,CD3CG,AF0CJ,CCRgB,CDS5B,ACT6BtG,CClCV,ADkCS,CClCR,ADkCC,CDQT,ACRoB6C,EDS3B,CE3Cc,EAAO,ADkCd,CESf,AHDe,CGCcJ,CD3CP,AF2CR,EE3CoB,CF0CnB,EE1CO,AF4CxB,CGDE,AHDe,CE1CwB,CF4CtC,CAFc,EE1CO,AF4ClB,CE5CV,EF0CqB,EAEN,CAFM,EAGjB,EAHiB,EAGb,EAHa,EAGT,EAHS,EAGL,EAHK,EAIjB,GAJiB,EAIZ,GAJY,EAIP,GAJO,EAIF,GAJE,EAKjB,IALiB,EAKX,IALW,EAKL,IALK,EAKC,IALD,EAMjB,KANiB,EAMV,KANU,EAMH,KANG,EAMI,KANJ,CAAnB;AGEG,AD1CL,AFgDE,AChB8CK,IChC5CuD,CC0BA,CHsBEzG,IAAI,AChBsCkD,GDgBnC,CAACpD,CEhDC,GAAG,EAAlB,AFgDoB,AChBsC,CDgBrC,CAAD,AChBwC,CDgB9C,GAAYA,MAAM,CAAC,CAAD,CAAnB,IAA0BD,MAArC;AGLC,ADzCH,AF+CE,ACjBmB,MDiBfI,GCjBE,KDiBM,GAAG,EAAf;AGLD,AHMC,ACjBK,CE/BP,EA0CGX,EA1CH,CHgDMY,CCpBiI,CAKjI,MDeQ,GAAGH,UAAU,CAACA,UAAU,CAACI,MAAX,GAAoB,CAArB,CAAzB;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,UA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DpCF3F,OAAO,CCoCG,ADpCFM,GCoCK8C,KDpCN,CAAP,CAAkB/C,ECoCI,GAAG,GAA7B,EDpCI,CAA6BI,YAA7B,EAA2CG,OAA3C,CAAmDC,SAAnD,EAA8DC,MAA9D,CAAqEC,QAArE,EAA+EU,QAA/E,CAAwFM,GAAxF,CAA4FhC,OAAO,CAACxC,CAAD,CAAP,CAAWiC,IAAvG,EAA6GO,OAAO,CAACxC,CAAD,CAAP,CAAW0E,QAAxH;ACqCJsD,AFLA/G,AC/BIwB,ECoCJuF,AFLA/G,CAAC,GAAG,AC/BAwB,ECoCE,CAACrD,CFLC8B,GC/BG,CD+BP,AC/BQ6B,CCoCZ,AFLa7B,CEKC,GFLG,CAACC,EEKlB,ADpCW,CD+BE,AC/BT,CCqCD9B,AFNmB4B,AC/BA6B,CD+BC,CAAC1B,EEKxB,CACQ,KDrCJ,CAA6B8B,CCoCjC,CFLsB,CEMLgF,CFNJ,EAA0BjH,CAAC,CAACI,IC/BrC,ECoCJ,ADpC+CgC,ECsC5ChE,AFPoC,EAA1B,EEKb,AFLqD4B,CEO7C,AFP8C,AC/BlD,CD+BmDK,AC/BAgC,ECoCvD,EAEaoE,GFPwC,EEOnC,AFPL,AC/BT,CD+BA,CAAJ,AC/BkEnE,CCsC7CiC,AFTW,CAGhC,IChCI,CCsCuB,ADtC8ChC,CCsC7CkC,KAAf,EDtCT,CCsCgCG,CDtC+CzB,QCoCnF,EAGG/E,CDvCC,CAA2FmF,ECoC/F,CAGQ,ADvCJ,CAA+FhC,OCoCnG,ADpC0G,CAACxC,CCuCzFkI,ADvCwF,CAAP,CAAWjG,IAA1G,EAAgHO,GCoCpH,EAIGnD,EDxCwH,CAACW,CCoC5H,ADpC2H,CCwCnH,ADxC4G,CAAW2E,ECoC/H,EAIasD,OAAO,GAAGG,EDxCnB,MCoCJ,EAKG/I,IALH,CAKQ,QALR,EAKkB0G,qBALlB,EAMG1G,IANH,CAMQ,MANR,EAMgB8G,eAAe,CAAC,CAAD,CAN/B;AAOA6B,AFVA,AChCIvF,EC0CJuF,ID1CIvF,EC0CE,CAACrD,ID1CI,CAAC2D,CC0CZ,CAAc,MAAd,AD1CW,CAAP,CC2CD1D,AD3CmByD,IC0CtB,CACQ,GADR,EACa4E,AD3CT,CAA6BxE,IC2Cf,GAAGsC,KD3CjB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","file":"src.e31bb0bc.js","sourceRoot":"..\\src","sourcesContent":["\r\n/**\r\n * Generates the SVG element g which will contain the map base.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMapG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'map-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Generates the SVG element g which will contain the map markers.\r\n *\r\n * @param {number} width The width of the graph\r\n * @param {number} height The height of the graph\r\n * @returns {*} The d3 Selection for the created g element\r\n */\r\nexport function generateMarkerG (width, height) {\r\n  return d3.select('.graph')\r\n    .select('svg')\r\n    .append('g')\r\n    .attr('id', 'marker-g')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n/**\r\n * Sets the size of the SVG canvas containing the graph.\r\n *\r\n * @param {number} width The desired width\r\n * @param {number} height The desired height\r\n */\r\nexport function setCanvasSize (width, height) {\r\n  d3.select('#map').select('svg')\r\n    .attr('width', width)\r\n    .attr('height', height)\r\n}\r\n\r\n\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {number} The best step to use\r\n */\r\nexport function getClosestStep (nSteps, domain) {\r\n  const BEST_STEPS = [\r\n    0.1, 0.2, 0.25, 0.5,\r\n    1, 2, 2.5, 5,\r\n    10, 20, 25, 50,\r\n    100, 200, 250, 500,\r\n    1000, 2000, 2500, 5000,\r\n    10000, 20000, 25000, 50000\r\n  ]\r\n  var step = (domain[1] - domain[0]) / nSteps\r\n  var stepDiff = []\r\n  var bestStep = BEST_STEPS[BEST_STEPS.length - 1]\r\n  for (let i = 0; i < BEST_STEPS.length; i++) {\r\n    stepDiff.push(Math.abs(BEST_STEPS[i] - step))\r\n    if (i > 0 && stepDiff[i] > stepDiff[i - 1]) {\r\n      bestStep = BEST_STEPS[i - 1]\r\n      break\r\n    }\r\n  }\r\n  return bestStep\r\n}\r\n\r\n/**\r\n * @param {number} nSteps The ideal number of steps\r\n * @param {*} domain Domain of d3 scale\r\n * @returns {Array<number>} The best steps\r\n */\r\nexport function getSteps (nSteps, domain) {\r\n  var step = getClosestStep(nSteps, domain)\r\n  var steps = []\r\n  if (domain[0] <= 0 && domain[1] >= 0) {\r\n    steps.push(0)\r\n  } else {\r\n    let firstStep = Math.floor(domain[0])\r\n    while (firstStep % step !== 0) {\r\n      firstStep += 1\r\n    }\r\n    steps.push(firstStep)\r\n  }\r\n  while (steps[steps.length - 1] < domain[1] - step) {\r\n    steps.push(steps[steps.length - 1] + step)\r\n  }\r\n  while (steps[0] > domain[0] + step) {\r\n    steps.unshift(steps[0] - step)\r\n  }\r\n  return steps\r\n}\r\n\r\n/**\r\n * @param {Array<number>} array Array of numeric values\r\n * @returns {Array<number>} The quantiles\r\n */\r\nexport function getQuantiles (array) {\r\n  array = array.sort(d3.ascending)\r\n  const quantiles = [\r\n    array[0],\r\n    d3.quantile(array, 0.25),\r\n    d3.median(array),\r\n    d3.quantile(array, 0.75),\r\n    array[array.length - 1]\r\n  ]\r\n  return quantiles\r\n}\r\n\r\n/**\r\n * @param {Date} d date\r\n * @returns {number} weekNo\r\n */\r\nexport function getWeekNumber (d) {\r\n  // Copy date so don't modify original\r\n  d = new Date(Date.UTC(d.getFullYear(), d.getMonth(), d.getDate()))\r\n  // Set to nearest Thursday: current date + 4 - current day number\r\n  // Make Sunday's day number 7\r\n  d.setUTCDate(d.getUTCDate() + 4 - (d.getUTCDay() || 7))\r\n  // Get first day of year\r\n  var yearStart = new Date(Date.UTC(d.getUTCFullYear(), 0, 1))\r\n  // Calculate full weeks to nearest Thursday\r\n  var weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7)\r\n  // Return array of year and week number\r\n  return [d.getUTCFullYear(), weekNo]\r\n}\r\n","// INF8808 - Exo\r\n//\r\n// Adam Prévost - 1947205\r\n// Armelle Jézéquel - 2098157\r\n// Clara Serruau - 2164678\r\n// Jules Lefebvre - 1847158\r\n// Julien Dupuis - 1960997\r\n//\r\n\r\n/**\r\n * Ajout de champs à l'objet\r\n * jour_semaine {0, 1, 2, 3, 4, 5, 6} où 0 = Dimanche\r\n * type_jour {semaine, fin de semaine}\r\n * ferie {true, false}\r\n *\r\n * @param {object[]} data L'array d'objets qui contient les lignes du csv\r\n */\r\nexport function addDayType (data) {\r\n  for (var i = 0; i < data.length; i++) {\r\n    // jour_semaine\r\n    data[i].jour_semaine = data[i].date.getDay()\r\n\r\n    // type_jour\r\n    data[i].jour_semaine === (0 || 6) ? data[i].type_jour = 'fin de semaine' : data[i].type_jour = 'semaine'\r\n\r\n    // ferie\r\n    isNaN(data[i].voyage) ? data[i].ferie = true : data[i].ferie = false\r\n  }\r\n}\r\n/**\r\n * aggregateData() remplit l'objet vizData à partir des données du csv (data)\r\n *\r\n * @param {*} csvData L'array d'objets qui contient les lignes du csv, modifié par preprocess.addDayType()\r\n * @param {*} vizData L'array d'objets qui contient les données consolidées requises pour générer les viz\r\n * @param {*} startDate Date de début\r\n * @param {*} endDate Date de fin\r\n * @param {*} typeJour On considère semaine ou weekend\r\n * @param {*} ferie On considère les fériés si true\r\n */\r\nexport function aggregateData (csvData, vizData, startDate, endDate, typeJour, ferie) {\r\n  // Boucle sur les lignes de csvData pour remplir la structure vizData\r\n  for (var i = 0; i < csvData.length; i++) {\r\n    if (csvData[i].date >= startDate && csvData[i].date <= endDate && csvData[i].type_jour === typeJour && csvData[i].ferie === ferie) {\r\n      if (vizData.length === 0) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n      }\r\n\r\n      // On ajoute la ligne si elle n'existe pas déjà dans vizData\r\n      var posLigne = vizData.findIndex(e => e.ligne === csvData[i].ligne)\r\n      if (posLigne === -1) {\r\n        vizData.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n        posLigne = vizData.length - 1\r\n      }\r\n\r\n      // On ajoute la girouette si elle n'existe pas déjà dans vizData\r\n      var posGirouette = vizData[posLigne].girouettes.findIndex(e => e.girouette === csvData[i].Girouette)\r\n      if (posGirouette === -1) {\r\n        vizData[posLigne].girouettes.push({ girouette: csvData[i].Girouette, voyages: [] })\r\n        posGirouette = vizData[posLigne].girouettes.length - 1\r\n      }\r\n\r\n      // On ajoute le voyage s'il n'existe pas déjà dans vizData\r\n      var posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.findIndex(e => e.voyage === csvData[i].voyage)\r\n      if (posVoyage === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages.push({ voyage: csvData[i].voyage, arrets: [] })\r\n        posVoyage = vizData[posLigne].girouettes[posGirouette].voyages.length - 1\r\n      }\r\n\r\n      // On ajoute l'arrêt s'il n'existe pas déjà dans vizData\r\n      var posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.findIndex(e => e.codeArret === csvData[i].arret_code)\r\n      if (posArret === -1) {\r\n        vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.push(\r\n          {\r\n            codeArret: csvData[i].arret_code,\r\n            nomArret: csvData[i].arret_nom,\r\n            sequenceArret: csvData[i].sequence_arret,\r\n            minutesEcart: new Map(),\r\n            moyMinutesEcart: null,\r\n            nClients: new Map(),\r\n            moyNClients: null,\r\n            ponctualite: new Map(),\r\n            tauxPonctualite: null,\r\n            minutesEcartClient: new Map(),\r\n            moyMinutesEcartClient: null\r\n          })\r\n        posArret = vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.length - 1\r\n      }\r\n\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcart.set(csvData[i].date, csvData[i].Minutes_ecart_planifie)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].nClients.set(csvData[i].date, csvData[i].montants)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].ponctualite.set(csvData[i].date, csvData[i].Etat_Ponctualite)\r\n      vizData[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets[posArret].minutesEcartClient.set(csvData[i].date, csvData[i].Minutes_ecart_planifie * csvData[i].montants)\r\n    }\r\n  }\r\n\r\n  // Parcours de vizData pour calculer les indicateurs pour chaque ligne.arret\r\n  vizData.forEach(function (ligne) {\r\n    ligne.girouettes.forEach(function (girouette) {\r\n      girouette.voyages.forEach(function (voyage) {\r\n        voyage.arrets.forEach(function (arret) {\r\n          var sumMinutesEcart = 0\r\n          arret.minutesEcart.forEach(v => { sumMinutesEcart += v })\r\n          arret.moyMinutesEcart = sumMinutesEcart / arret.minutesEcart.size\r\n\r\n          var sumNClients = 0\r\n          arret.nClients.forEach(v => { sumNClients += v })\r\n          arret.moyNClients = sumNClients / arret.nClients.size\r\n\r\n          var sumMinutesEcartClient = 0\r\n          arret.minutesEcartClient.forEach(v => { sumMinutesEcartClient += v })\r\n          arret.moyMinutesEcartClient = sumMinutesEcartClient / arret.minutesEcartClient.size\r\n\r\n          var countPonctuel = 0\r\n          arret.ponctualite.forEach(v => { if (v === 'Ponctuel') { countPonctuel++ } })\r\n          arret.tauxPonctualite = countPonctuel / arret.ponctualite.size\r\n        })\r\n      })\r\n    })\r\n  })\r\n}\r\n\r\n/**\r\n * aggregateDataForViz3() remplit l'objet vizData à partir des données du csv (data)\r\n *\r\n * @param {*} csvData L'array d'objets qui contient les lignes du csv, modifié par preprocess.addDayType()\r\n * @param {*} vizData L'array d'objets qui contient les données consolidées requises pour générer les viz\r\n * @param {*} startDate Date de début\r\n * @param {*} endDate Date de fin\r\n * @param {*} typeJour On considère semaine ou weekend\r\n * @param {*} ferie On considère les fériés si true\r\n */\r\nexport function aggregateDataForViz3 (csvData, vizData, startDate, endDate, typeJour, ferie) {\r\n  // Boucle sur les lignes de csvData pour remplir la structure vizData\r\n  for (var i = 0; i < csvData.length; i++) {\r\n    if (csvData[i].date >= startDate && csvData[i].date <= endDate && csvData[i].type_jour === typeJour && csvData[i].ferie === ferie) {\r\n      if (vizData.length === 0) {\r\n        vizData.push({ date: csvData[i].date, lignes: [] })\r\n      }\r\n\r\n      // On ajoute la date si elle n'existe pas déjà dans vizData\r\n      var posDate = vizData.findIndex(e => e.date.valueOf() === csvData[i].date.valueOf())\r\n      if (posDate === -1) {\r\n        vizData.push({ date: csvData[i].date, lignes: [] })\r\n        posDate = vizData.length - 1\r\n      }\r\n\r\n      // On ajoute la ligne si elle n'existe pas déjà dans vizData\r\n      var posLigne = vizData[posDate].lignes.findIndex(e => e.ligne === csvData[i].ligne)\r\n      if (posLigne === -1) {\r\n        vizData[posDate].lignes.push({ ligne: csvData[i].ligne, girouettes: [] })\r\n        posLigne = vizData[posDate].lignes.length - 1\r\n      }\r\n\r\n      // On ajoute la girouette si elle n'existe pas déjà dans vizData\r\n      var posGirouette = vizData[posDate].lignes[posLigne].girouettes.findIndex(e => e.girouette === csvData[i].Girouette)\r\n      if (posGirouette === -1) {\r\n        vizData[posDate].lignes[posLigne].girouettes.push({ girouette: csvData[i].Girouette, voyages: [] })\r\n        posGirouette = vizData[posDate].lignes[posLigne].girouettes.length - 1\r\n      }\r\n\r\n      // On ajoute le voyage s'il n'existe pas déjà dans vizData\r\n      var posVoyage = vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages.findIndex(e => e.voyage === csvData[i].voyage)\r\n      if (posVoyage === -1) {\r\n        vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages.push({ voyage: csvData[i].voyage, arrets: [] })\r\n        posVoyage = vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages.length - 1\r\n      }\r\n\r\n      // On ajoute l'arrêt s'il n'existe pas déjà dans vizData\r\n      var posArret = vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.findIndex(e => e.codeArret === csvData[i].arret_code)\r\n      if (posArret === -1) {\r\n        vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.push(\r\n          {\r\n            codeArret: csvData[i].arret_code,\r\n            nomArret: csvData[i].arret_nom,\r\n            sequenceArret: csvData[i].sequence_arret,\r\n            minutesEcart: csvData[i].Minutes_ecart_planifie,\r\n            nClients: csvData[i].montants,\r\n            ponctualite: csvData[i].Etat_Ponctualite,\r\n            minutesEcartClient: csvData[i].Minutes_ecart_planifie * csvData[i].montants\r\n          })\r\n        posArret = vizData[posDate].lignes[posLigne].girouettes[posGirouette].voyages[posVoyage].arrets.length - 1\r\n      }\r\n    }\r\n  }\r\n}\r\n","import * as helper from './helper.js'\r\n\r\nconst MARGIN = { top: 52, right: 80, bottom: 100, left: 80 }\r\nconst FONT_SIZE = 14\r\nconst DIRECTIONS_ANGLE = -45\r\nconst QUANTILE_STROKE_COLOR = 'black'\r\nconst QUANTILE_FILL_COLOR = 'lightgray'\r\nconst QUANTILE_STROKE_WIDTH = 2\r\nconst NUMBER_OF_TICKS = 10\r\nconst GRADIENT_COLORS = ['#ff9999', '#99ff99', '#ffff99']\r\nconst GRADIENT_THRESHOLDS = ['10', '5', '0', '-5']\r\n\r\nvar selectValue = ''\r\n\r\n/**\r\n * @param vizData\r\n */\r\nexport function generateViz3 (vizData) {\r\n  // Split container in two\r\n  var container = d3.select('#grouped-quantile-graph-container')\r\n  var delayGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'left')\r\n  var trafficGraphContainer = container.append('div')\r\n    .style('width', '50%')\r\n    .style('height', '100%')\r\n    .style('float', 'right')\r\n\r\n  // TODO: Fetch data\r\n  var data = {}\r\n  data.lines = ['9', '22']\r\n  data.directions = ['Lafontaine', 'Montmorency', 'Côté', 'George VI']\r\n\r\n  // Regenerate graphs on resize\r\n  new ResizeObserver(() => { generateDelayGraph(delayGraphContainer, data, vizData) })\r\n    .observe(delayGraphContainer.node())\r\n  new ResizeObserver(() => { generateTrafficGraph(trafficGraphContainer, data, vizData) })\r\n    .observe(trafficGraphContainer.node())\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n * @param vizData\r\n */\r\nexport function generateDelayGraph (container, data, vizData) {\r\n  // Fetch data\r\n  data.quantileSets = getDelayQuantileSets(vizData)\r\n\r\n  // Generate common graph\r\n  data.title = 'Retard Moyen'\r\n  var [svg, dataScale] = generateGroupedQuantileGraph(container, data)\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n  var WIDTH = Math.min(HEIGHT, container.node().getBoundingClientRect().width)\r\n\r\n  // Set gradients\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'late-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[0], GRADIENT_COLORS[1]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  svg.append('defs')\r\n    .append('linearGradient')\r\n    .attr('id', 'early-grad')\r\n    .attr('x1', '0%')\r\n    .attr('x2', '0%')\r\n    .attr('y1', '0%')\r\n    .attr('y2', '100%')\r\n    .selectAll('stop')\r\n    .data([GRADIENT_COLORS[1], GRADIENT_COLORS[2]])\r\n    .enter()\r\n    .append('stop')\r\n    .style('stop-color', function (d) { return d })\r\n    .attr('offset', function (d, i) { return 100 * i + '%' })\r\n  // Draw gradients\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[0]) - MARGIN.top)\r\n    .attr('y', MARGIN.top)\r\n    .attr('fill', GRADIENT_COLORS[0])\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[1]) - dataScale(GRADIENT_THRESHOLDS[0]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[0]))\r\n    .attr('fill', 'url(#late-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[2]) - dataScale(GRADIENT_THRESHOLDS[1]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[1]))\r\n    .attr('fill', GRADIENT_COLORS[1])\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', dataScale(GRADIENT_THRESHOLDS[3]) - dataScale(GRADIENT_THRESHOLDS[2]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[2]))\r\n    .attr('fill', 'url(#early-grad)')\r\n  svg.insert('rect', '#x-axis')\r\n    .attr('width', WIDTH - MARGIN.left - MARGIN.right)\r\n    .attr('x', MARGIN.left)\r\n    .attr('height', HEIGHT - MARGIN.bottom - dataScale(GRADIENT_THRESHOLDS[3]))\r\n    .attr('y', dataScale(GRADIENT_THRESHOLDS[3]))\r\n    .attr('fill', GRADIENT_COLORS[2])\r\n\r\n  // Set y axis label\r\n  svg.select('#y-axis > .label')\r\n    .text('Minute')\r\n    .attr('fill', '#898989')\r\n\r\n  // Legend\r\n  const legend = svg.insert('g', '#x-axis').style('font-size', '12px')\r\n  const middleY = (HEIGHT - MARGIN.top - MARGIN.bottom) / 2 + MARGIN.top\r\n  const squareWidth = FONT_SIZE * 2 / 3\r\n  const paddingX = FONT_SIZE * 2\r\n  const paddingY = FONT_SIZE * 1.5\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY - paddingY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[0])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY - paddingY + squareWidth)\r\n    .text('Retard')\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[1])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY + squareWidth)\r\n    .text('Ponctuel')\r\n  legend.append('rect')\r\n    .attr('width', squareWidth)\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE)\r\n    .attr('height', squareWidth)\r\n    .attr('y', middleY + paddingY)\r\n    .attr('stroke', QUANTILE_STROKE_COLOR)\r\n    .attr('fill', GRADIENT_COLORS[2])\r\n  legend.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + paddingX)\r\n    .attr('y', middleY + paddingY + squareWidth)\r\n    .text('Avance')\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n * @param vizData\r\n */\r\nexport function generateTrafficGraph (container, data, vizData) {\r\n  // Fetch data\r\n  const [quantileTripSets, quantileDaySets, quantileWeekSets] = getTrafficQuantileSets(vizData)\r\n  if (selectValue === '') {\r\n    data.quantileSets = quantileTripSets\r\n  } else {\r\n    if (selectValue === 'week') {\r\n      data.quantileSets = quantileWeekSets\r\n    } else if (selectValue === 'day') {\r\n      data.quantileSets = quantileDaySets\r\n    } else if (selectValue === 'trip') {\r\n      data.quantileSets = quantileTripSets\r\n    }\r\n  }\r\n\r\n  // Create select\r\n  const weekOption = document.createElement('option')\r\n  weekOption.value = 'week'\r\n  weekOption.innerHTML = 'semaine'\r\n  const dayOption = document.createElement('option')\r\n  dayOption.value = 'day'\r\n  dayOption.innerHTML = 'jour'\r\n  const tripOption = document.createElement('option')\r\n  tripOption.value = 'trip'\r\n  tripOption.innerHTML = 'trajet'\r\n  const select = document.createElement('select')\r\n  select.appendChild(tripOption)\r\n  select.appendChild(dayOption)\r\n  select.appendChild(weekOption)\r\n  if (selectValue !== '') {\r\n    select.value = selectValue\r\n  }\r\n  select.addEventListener('change', function () {\r\n    if (this.value === 'week') {\r\n      data.quantileSets = quantileWeekSets\r\n    } else if (this.value === 'day') {\r\n      data.quantileSets = quantileDaySets\r\n    } else if (this.value === 'trip') {\r\n      data.quantileSets = quantileTripSets\r\n    }\r\n    selectValue = this.value\r\n    setTrafficGraph(container, data, select)\r\n  })\r\n  // generate traffic graph\r\n  setTrafficGraph(container, data, select)\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to fetch\r\n * @param {object} select select\r\n */\r\nexport function setTrafficGraph (container, data, select) {\r\n  // Generate common graph\r\n  data.title = 'Achalandage Moyen'\r\n  var [svg] = generateGroupedQuantileGraph(container, data)\r\n\r\n  // Position select\r\n  const top = svg.node().getBoundingClientRect().top + 30\r\n  const left = svg.node().getBoundingClientRect().left + MARGIN.left - 70\r\n  select.setAttribute('style', `position: absolute; top: ${top}px; left: ${left}px; font-size: 12px`)\r\n  container.node().appendChild(select)\r\n\r\n  // Label\r\n  svg.select('#y-axis > .label')\r\n    .text('')\r\n  svg.select('#y-axis > .label')\r\n    .append('tspan')\r\n    .attr('x', (MARGIN.left - 1).toString())\r\n    .attr('y', '13')\r\n    .text('Nombre de')\r\n  svg.select('#y-axis > .label')\r\n    .append('tspan')\r\n    .attr('x', (MARGIN.left + 9).toString())\r\n    .attr('y', '25')\r\n    .text('personnes par')\r\n}\r\n\r\n/**\r\n * @param {Selection} container The div to generate the graph in\r\n * @param {object} data The data to display\r\n * @returns {Selection} The generated graph as svg\r\n */\r\nexport function generateGroupedQuantileGraph (container, data) {\r\n  // ===================== SETUP =====================\r\n\r\n  // Delete existing content\r\n  container.html('')\r\n  // Set size\r\n  var HEIGHT = container.node().getBoundingClientRect().height\r\n  var WIDTH = Math.min(HEIGHT, container.node().getBoundingClientRect().width)\r\n  var BAR_WIDTH = (WIDTH - MARGIN.left - MARGIN.right) / 7\r\n  // Create svg\r\n  var svg = container.append('svg')\r\n    .attr('width', WIDTH)\r\n    .attr('height', HEIGHT)\r\n    .attr('style', 'display: block; margin: auto')\r\n\r\n  // ===================== SCALES =====================\r\n\r\n  // Create lines scale\r\n  var linesScale = d3.scaleOrdinal()\r\n    .domain(data.lines)\r\n    .range([MARGIN.left + 2 * BAR_WIDTH, MARGIN.left + 5 * BAR_WIDTH])\r\n  // Create directions scale\r\n  var directionsRange = []\r\n  for (const line of data.lines) {\r\n    directionsRange.push(linesScale(line) - BAR_WIDTH / 2)\r\n    directionsRange.push(linesScale(line) + BAR_WIDTH / 2)\r\n  }\r\n  var directionsScale = d3.scaleOrdinal()\r\n    .domain([...data.directions])\r\n    .range(directionsRange)\r\n  // Create data scale\r\n  var maxValue = Number.MIN_SAFE_INTEGER\r\n  var minValue = Number.MAX_SAFE_INTEGER\r\n  for (const quantiles of data.quantileSets) {\r\n    for (const quantile of quantiles) {\r\n      if (maxValue < quantile) {\r\n        maxValue = quantile\r\n      }\r\n      if (minValue > quantile) {\r\n        minValue = quantile\r\n      }\r\n    }\r\n  }\r\n  var dataScale = d3.scaleLinear()\r\n    .domain([Math.min(minValue, 0), maxValue])\r\n    .range([HEIGHT - MARGIN.bottom - FONT_SIZE / 2, MARGIN.top + FONT_SIZE / 2])\r\n\r\n  // ===================== X AXIS =====================\r\n\r\n  var xAxis = svg.append('g')\r\n    .attr('id', 'x-axis')\r\n  // Draw axis line\r\n  xAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom],\r\n      [MARGIN.left + 7 * BAR_WIDTH, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Draw line values\r\n  const lineValuesY = HEIGHT - MARGIN.bottom + FONT_SIZE * 1.5\r\n  for (const line of data.lines) {\r\n    xAxis.append('text')\r\n      .attr('x', linesScale(line))\r\n      .attr('y', lineValuesY)\r\n      .attr('text-anchor', 'middle')\r\n      .text(line)\r\n      .attr('fill', '#898989')\r\n      .style('font-size', FONT_SIZE)\r\n  }\r\n  // Draw direction values\r\n  const directionValuesY = lineValuesY + FONT_SIZE\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    xAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('transform', `translate(${x}, ${directionValuesY}) rotate(${DIRECTIONS_ANGLE})`)\r\n      .text(data.directions[i])\r\n      .style('font-size', '12px')\r\n      .attr('font-family', 'sans-serif')\r\n      .attr('class', `direction${i} label`)\r\n  }\r\n  // Draw labels\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', lineValuesY)\r\n    .text('Ligne')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n  xAxis.append('text')\r\n    .attr('x', WIDTH - MARGIN.right + FONT_SIZE / 2)\r\n    .attr('y', directionValuesY + FONT_SIZE)\r\n    .text('Direction')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== Y AXIS =====================\r\n\r\n  var yAxis = svg.append('g')\r\n    .attr('id', 'y-axis')\r\n  // Draw axis line\r\n  yAxis.append('path')\r\n    .attr('d', d3.line()([\r\n      [MARGIN.left, MARGIN.top],\r\n      [MARGIN.left, HEIGHT - MARGIN.bottom]\r\n    ]))\r\n    .attr('stroke', 'black')\r\n  // Generate steps\r\n  var steps = helper.getSteps(NUMBER_OF_TICKS, dataScale.domain())\r\n  for (const step of steps) {\r\n    const y = dataScale(step)\r\n    // Draw data values\r\n    yAxis.append('text')\r\n      .attr('text-anchor', 'end')\r\n      .attr('x', MARGIN.left - FONT_SIZE)\r\n      .attr('y', y + FONT_SIZE / 3)\r\n      .text(step)\r\n      .attr('font-family', 'sans-serif')\r\n      .style('font-size', FONT_SIZE)\r\n    // Draw ticks\r\n    yAxis.append('path')\r\n      .attr('d', d3.line()([\r\n        [MARGIN.left - FONT_SIZE / 2, y],\r\n        [MARGIN.left, y]]\r\n      ))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n  }\r\n  // Draw labels\r\n  yAxis.append('text')\r\n    .attr('x', MARGIN.left - FONT_SIZE / 2)\r\n    .attr('y', MARGIN.top - FONT_SIZE / 2)\r\n    .attr('class', 'label')\r\n    .attr('text-anchor', 'end')\r\n    .text('Unité de données')\r\n    .attr('fill', '#898989')\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  // ===================== CANDLES =====================\r\n\r\n  var bars = svg.append('g')\r\n    .attr('id', 'candles')\r\n\r\n  // HISTOGRAMME\r\n\r\n  /* for (let i = 0; i < data.quantileSets.length; i++) {\r\n    // Features of the histogram\r\n    var histogram = d3.histogram()\r\n      .domain(dataScale.domain())\r\n      .thresholds(dataScale.ticks(50)) // Important: how many bins approx are going to be made? It is the 'resolution' of the violin plot\r\n      .value(d => d)\r\n    const bins = histogram(data.quantileSets[i])\r\n    // What is the biggest number of value in a bin? We need it cause this value will have a width of 100% of the bandwidth.\r\n    var maxNum = 0\r\n    for (const bin of bins) {\r\n      if (bin.length > maxNum) {\r\n        maxNum = bin.length\r\n      }\r\n    }\r\n    // The maximum width of a violin must be x.bandwidth = the width dedicated to a group\r\n    var xNum = d3.scaleLinear()\r\n      .range([0, BAR_WIDTH])\r\n      .domain([-maxNum, maxNum])\r\n    // Add the shape to this svg!\r\n    const areaGenerator = d3.area()\r\n      .x0((d) => xNum(-d.length))\r\n      .x1((d) => xNum(d.length))\r\n      .y((d) => dataScale(d.x0))\r\n      .curve(d3.curveStep)\r\n    bars.append('path')\r\n      .attr('transform', `translate(${directionsScale(data.directions[i]) - BAR_WIDTH / 2})`)\r\n      .style('fill', '#69b3a2')\r\n      .attr('d', areaGenerator(bins))\r\n  } */\r\n\r\n  for (let i = 0; i < data.quantileSets.length; i++) {\r\n    const x = directionsScale(data.directions[i])\r\n    const top = dataScale(data.quantileSets[i][4])\r\n    const q3 = dataScale(data.quantileSets[i][3])\r\n    const q2 = dataScale(data.quantileSets[i][2])\r\n    const q1 = dataScale(data.quantileSets[i][1])\r\n    const bottom = dataScale(data.quantileSets[i][0])\r\n    // Draw domain line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x, top], [x, bottom]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q1 to Q3 bar\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', x - BAR_WIDTH / 2)\r\n      .attr('height', q1 - q3)\r\n      .attr('y', q3)\r\n      .attr('fill', QUANTILE_FILL_COLOR)\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw Q2 line\r\n    bars.append('path')\r\n      .attr('d', d3.line()([[x - BAR_WIDTH / 2, q2], [x + BAR_WIDTH / 2, q2]]))\r\n      .attr('stroke', QUANTILE_STROKE_COLOR)\r\n      .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n      .attr('class', `direction${i}`)\r\n    // Draw quantile values\r\n    const yValues = [0, 0, 0, 0, 0]\r\n    const minOffset = 11\r\n    const centerOffset = 4\r\n    yValues[2] = dataScale(data.quantileSets[i][2]) + centerOffset\r\n    yValues[3] = Math.min(yValues[2] - minOffset, dataScale(data.quantileSets[i][3]) + centerOffset)\r\n    yValues[4] = Math.min(yValues[3] - minOffset, dataScale(data.quantileSets[i][4]) + centerOffset)\r\n    yValues[1] = Math.max(yValues[2] + minOffset, dataScale(data.quantileSets[i][1]) + centerOffset)\r\n    yValues[0] = Math.max(yValues[1] + minOffset, dataScale(data.quantileSets[i][0]) + centerOffset)\r\n    for (let j = 0; j < data.quantileSets[i].length; j++) {\r\n      const quantile = bars.append('g')\r\n        .attr('class', `direction${i} quantile`)\r\n        .style('visibility', 'hidden')\r\n      const x = directionsScale(data.directions[i]) + (i % 2 === 0 ? -1 : 1) * (BAR_WIDTH / 2 + FONT_SIZE / 2)\r\n      quantile.append('text')\r\n        .attr('x', x)\r\n        .attr('y', yValues[j])\r\n        .attr('text-anchor', (i % 2 === 0 ? 'end' : 'start'))\r\n        .text(Math.round(data.quantileSets[i][j]))\r\n        .style('font-size', FONT_SIZE)\r\n        .attr('id', `quantile-text-${i}-${j}`)\r\n    }\r\n  }\r\n\r\n  // ===================== HOVER =====================\r\n\r\n  // Create triggers\r\n  for (let i = 0; i < data.directions.length; i++) {\r\n    bars.append('rect')\r\n      .attr('width', BAR_WIDTH)\r\n      .attr('x', directionsScale(data.directions[i]) - BAR_WIDTH / 2)\r\n      .attr('height', dataScale.range()[0] - dataScale.range()[1] + FONT_SIZE)\r\n      .attr('y', MARGIN.top)\r\n      .attr('fill', 'transparent')\r\n      // Highlight direction\r\n      .on('mouseover', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH * 2)\r\n        d3.selectAll(`.direction${i}.label`)\r\n          .attr('font-weight', 1000)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'visible')\r\n      // Unhighlight direction\r\n      }).on('mouseout', () => {\r\n        d3.selectAll(`.direction${i}`)\r\n          .attr('stroke-width', QUANTILE_STROKE_WIDTH)\r\n        d3.selectAll(`.direction${i}.label`)\r\n          .attr('font-weight', 0)\r\n        d3.selectAll(`.direction${i}.quantile`)\r\n          .style('visibility', 'hidden')\r\n      })\r\n  }\r\n\r\n  // ===================== OTHER =====================\r\n\r\n  // Draw Title\r\n  svg.append('text')\r\n    .attr('x', (WIDTH - MARGIN.right - MARGIN.left) / 2 + MARGIN.left)\r\n    .attr('y', MARGIN.top - FONT_SIZE * 2)\r\n    .attr('text-anchor', 'middle')\r\n    .text(data.title)\r\n    .style('font-size', FONT_SIZE)\r\n\r\n  return [svg, dataScale]\r\n}\r\n\r\n/**\r\n * @param {object} vizData Project data\r\n * @returns {Array<number>} The quantile sets\r\n */\r\nexport function getDelayQuantileSets (vizData) {\r\n  const quantileSets = []\r\n  const delaySets = [[], [], [], []]\r\n  for (const day of vizData) {\r\n    for (let i = 0; i < day.lignes.length; i++) {\r\n      const line = day.lignes[i]\r\n      for (let j = 0; j < line.girouettes.length; j++) {\r\n        const direction = line.girouettes[j]\r\n        for (const trip of direction.voyages) {\r\n          for (const stop of trip.arrets) {\r\n            delaySets[i * day.lignes.length + j].push(stop.minutesEcart)\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  for (const delaySet of delaySets) {\r\n    quantileSets.push(helper.getQuantiles(delaySet))\r\n  }\r\n  return quantileSets\r\n}\r\n\r\n/**\r\n * @param {object} vizData Project data\r\n * @returns {Array<number>} The quantile sets\r\n */\r\nexport function getTrafficQuantileSets (vizData) {\r\n  const tripSets = [[], [], [], []]\r\n  const daySets = [[], [], [], []]\r\n  const weekSets = [[], [], [], []]\r\n  let lastWeek = helper.getWeekNumber(new Date(Date.parse(vizData[0].date)))[1]\r\n  let weekClients = [0, 0, 0, 0]\r\n  for (const day of vizData) {\r\n    const week = helper.getWeekNumber(new Date(Date.parse(day.date)))[1]\r\n    for (let i = 0; i < day.lignes.length; i++) {\r\n      const line = day.lignes[i]\r\n      for (let j = 0; j < line.girouettes.length; j++) {\r\n        const direction = line.girouettes[j]\r\n        let dayClients = 0\r\n        for (const trip of direction.voyages) {\r\n          let tripClients = 0\r\n          for (const stop of trip.arrets) {\r\n            tripClients += stop.nClients\r\n          }\r\n          dayClients += tripClients\r\n          tripSets[i * day.lignes.length + j].push(tripClients)\r\n        }\r\n        daySets[i * day.lignes.length + j].push(dayClients)\r\n        weekClients[i * day.lignes.length + j] += dayClients\r\n      }\r\n    }\r\n    if (lastWeek !== week) {\r\n      for (let i = 0; i < weekClients.length; i++) {\r\n        weekSets[i].push(weekClients[i])\r\n      }\r\n      weekClients = [0, 0, 0, 0]\r\n      lastWeek = week\r\n    }\r\n  }\r\n  const quantileTripSets = []\r\n  for (const tripSet of tripSets) {\r\n    quantileTripSets.push(helper.getQuantiles(tripSet))\r\n  }\r\n  const quantileDaySets = []\r\n  for (const daySet of daySets) {\r\n    quantileDaySets.push(helper.getQuantiles(daySet))\r\n  }\r\n  const quantileWeekSets = []\r\n  for (const weekSet of weekSets) {\r\n    quantileWeekSets.push(helper.getQuantiles(weekSet))\r\n  }\r\n  return [quantileTripSets, quantileDaySets, quantileWeekSets]\r\n}\r\n","'use strict'\r\n\r\nimport * as helper from './scripts/helper.js'\r\nimport * as preprocess from './scripts/preprocess.js'\r\nimport * as groupedQuantile from './scripts/grouped-quantile.js'\r\n\r\n/**\r\n * @file \r\n * @author Adam Prévost, Armelle Jézéquel, Clara Serruau, Jules Lefebvre, Julien Dupuis\r\n * @version 1.0.0\r\n * \r\n * La structure du projet est inspirée de celle employé pour les TPs de INF8808 créée par Olivia Gélinas.\r\n */\r\n\r\n(function (d3) {\r\n  const svgSize = {\r\n    width: 800,\r\n    height: 625\r\n  }\r\n\r\n  helper.setCanvasSize(svgSize.width, svgSize.height)\r\n  helper.generateMapG(svgSize.width, svgSize.height)\r\n  helper.generateMarkerG(svgSize.width, svgSize.height)\r\n\r\n  // Solution temporaire, éventuellement l'utilisateur peut choisir la période qui l'intéresse, s'il veut inclure les week-end et les fériés.\r\n  const startDate = new Date('2021/09/01')\r\n  const endDate = new Date('2021/12/01')\r\n  const typeJour = 'semaine'\r\n  const ferie = false\r\n\r\n  var vizData = []\r\n\r\n  build()\r\n\r\n  /**\r\n   *   Cette fonction construit la page web\r\n   */\r\n  function build () {\r\n    d3.csv('./donnees_L9_L22.csv').then(function (csvData) {\r\n      // Change les string pour les types appropriés\r\n      csvData.forEach(function (d) {\r\n        d.date = new Date(d.date + ' 00:00:00')\r\n        d.ligne = +d.ligne\r\n        d.voyage = +d.voyage\r\n        d.arret_code = +d.arret_code\r\n        d.montants = +d.montants\r\n        d.Minutes_ecart_planifie = +d.Minutes_ecart_planifie\r\n        d.sequence_arret = +d.sequence_arret\r\n        d.arret_Latitude = +d.arret_Latitude\r\n        d.arret_Longitude = +d.arret_Longitude\r\n      })\r\n      preprocess.addDayType(csvData)\r\n      preprocess.aggregateDataForViz3(csvData, vizData, startDate, endDate, typeJour, ferie)\r\n      groupedQuantile.generateViz3(vizData)\r\n    })\r\n  }\r\n})(d3)\r\n"]}